<!DOCTYPE html>
<html lang="en-us">
	<head>

		<meta charset="UTF-8">
		<title>HYBC</title>

		<!-- Bootstrap CSS & JS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<!-- jQuery -->
		<script src="https://code.jquery.com/jquery.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

	</head>
	<body>
		
		<div class="container">

			<div class="jumbotron">
				<h1>HYBC</h1>
				<h3>T-Shirts!</h3>
				<hr>
				<a href="/search" class="btn btn-danger btn-lg"><span class="glyphicon glyphicon-eye-open"></span> Search Products</a>
				<a href="/add" class="btn btn-danger btn-lg"><span class="glyphicon glyphicon-plus"></span> Add New Product</a>
				<a href="/" class="btn btn-danger btn-lg"><span class="glyphicon glyphicon-th-list"></span> All Products</a>
			</div>

			<div class="row">
				<div class="col-lg-12">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title"><strong>Product Search</strong></h3>
						</div>
						<div class="panel-body">
							<input type="text" id="product-search" class="form-control">
							<br>
							<div class="text-right">
								<button type="submit" class="btn btn-primary btn-md" id="search-btn"><span class="glyphicon glyphicon-search"></span> Search For Your Next T-Shirt!</button>
							</div>
						</div>
					</div>
				</div>			
			</div>

			<div class="row">

				<div class="col-lg-12">

					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title"><strong>Search Results</strong></h3>
						</div>
						<div class="panel-body" id="well-section">
					
						<!-- Content will go in here -->

						</div>
					</div>
				</div>			
			</div>

		</div>
		
	<!-- Custom Script -->
	<script type="text/javascript">
		
		// Code here handles queries for specific products in the database
		// In this case, the user submits a products name... we then pass that product's name as a
		// URL parameter. Our server then performs the search to grab that product from the Database.

		// when user hits the search-btn
		$("#search-btn").on("click", function() {
		  // save the product they typed into the product-search input
		  var searchedProduct = $("#product-search")
		    .val()
		    .trim();

		  // Using a RegEx Pattern to remove spaces from searchedCharacter
		  searchedProduct = searchedProduct.replace(/\s+/g, "").toLowerCase();

		  // we run an AJAX GET-request for our servers api,
		  // including the user's product in the url
		  $.get("/api/" + searchedProduct, function(data) {
		    // log the data to our console
		    console.log(data);
		    // empty to well-section before adding new content
		    $("#well-section").empty();
		    // if the data is not there, then return an error message
		    if (!data) {
		      $("#well-section").append("<h2> Sorry! No results found. </h2>");
		    }
		    else {
		      // otherwise
		      // append the product name
		      $("#well-section").append("<h2>" + data.product_name + "</h2>");
		      // the product kimd
		      $("#well-section").append("<h3>Kind: " + data.product_kind + "</h3>");
		      // the department name
		      $("#well-section").append("<h3>Department: " + data.department_name + "</h3>");
		      // the price
		      $("#well-section").append("<h3>Price: " + data.price + "</h3>");
		      // and the stock quantity
		      $("#well-section").append("<h3>Stock Quantity: " + data.stock_quantity + "</h3>");
		    }
		  });
		});


	</script>
	</body>
</html>
